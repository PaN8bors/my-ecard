/**
 * This is the customization panel and settings management module. The main
 * component is generated by the Customization function at the bottom. This
 * module then handles the user's inputs and generates a shareable link upon
 * clicking the share button.
 */
import "./Customize.css";

/**
 * The ICONS array holds all of the options that the user has when choosing an
 * icon for the greeting card. The icons originate from the following URL and
 * is not intentionally kept up-to-date.
 * https://github.com/dohliam/elegant-circles
 */
const ICONS = ["Select Icon", "art", "bike", "blimp", "bolt", "briefcase", "brightness", "calendar", "chat", "cloud", "computer", "contacts", "crossroads", "cruise", "denied", "door", "filmreel", "flame", "flower", "globe", "heart", "hotair", "hourglass", "image", "key", "locked", "magicwand", "mail", "map", "megaphone", "mic", "music", "parachute", "phone", "rocket", "sailboat", "shoeprints", "spaceshuttle", "star", "sub", "submarine", "traffic", "travelerbag", "trophy", "tv", "ufo", "umbrella", "video", "water", "weather",];

/**
 * The PATTERNS array holds all of the card background patterns options.
 * Origin: https://github.com/mike-hearn/transparent-textures
 */
const PATTERNS = ["No Background Pattern", "3px-tile", "45-degree-fabric-dark", "45-degree-fabric-light", "60-lines", "absurdity", "ag-square", "always-grey", "arabesque", "arches", "argyle", "asfalt-dark", "asfalt-light", "assault", "axiom-pattern", "az-subtle", "back-pattern", "basketball", "batthern", "bedge-grunge", "beige-paper", "billie-holiday", "binding-dark", "binding-light", "black-felt", "black-linen", "black-linen-2", "black-lozenge", "black-mamba", "black-orchid", "black-paper", "black-scales", "black-thread-light", "black-thread", "black-twill", "blizzard", "blu-stripes", "bo-play", "brick-wall-dark", "brick-wall", "bright-squares", "brilliant", "broken-noise", "brushed-alum-dark", "brushed-alum", "buried", "candyhole", "carbon-fibre", "carbon-fibre-big", "carbon-fibre-v2", "cardboard-flat", "cardboard", "cartographer", "checkered-light-emboss", "checkered-pattern", "church", "circles", "classy-fabric", "clean-gray-paper", "clean-textile", "climpek", "cloth-alike", "concrete-wall", "concrete-wall-2", "concrete-wall-3", "connected", "corrugation", "cream-dust", "cream-paper", "cream-pixels", "crisp-paper-ruffles", "crissxcross", "cross-scratches", "cross-stripes", "crossword", "cubes", "cutcube", "dark-brick-wall", "dark-circles", "dark-denim", "dark-denim-3", "dark-dot", "dark-dotted-2", "dark-exa", "dark-fish-skin", "dark-geometric", "dark-leather", "dark-matter", "dark-mosaic", "dark-stripes-light", "dark-stripes", "dark-tire", "dark-wall", "dark-wood", "darth-stripe", "debut-dark", "debut-light", "diagmonds-light", "diagmonds", "diagonal-noise", "diagonal-striped-brick", "diagonal-waves", "diagonales-decalees", "diamond-eyes", "diamond-upholstery", "diamonds-are-forever", "dimension", "dirty-old-black-shirt", "dotnoise-light-grey", "double-lined", "dust", "ecailles", "egg-shell", "elastoplast", "elegant-grid", "embossed-paper", "escheresque-dark", "escheresque", "exclusive-paper", "fabric-1-dark", "fabric-1-light", "fabric-of-squares", "fabric-plaid", "fake-brick", "fake-luxury", "fancy-deboss", "farmer", "felt", "first-aid-kit", "flower-trail", "flowers", "foggy-birds", "food", "football-no-lines", "french-stucco", "fresh-snow", "gold-scale", "gplay", "gradient-squares", "graphcoders-lil-fiber", "graphy-dark", "graphy", "gravel", "gray-floral", "gray-lines", "gray-sand", "green-cup", "green-dust-and-scratches", "green-fibers", "green-gobbler", "grey-jean", "grey-sandbag", "grey-washed-wall", "greyzz", "grid-me", "grid-noise", "grid", "grilled-noise", "groovepaper", "grunge-wall", "gun-metal", "handmade-paper", "hexabump", "hexellence", "hixs-evolution", "hoffman", "honey-im-subtle", "ice-age", "inflicted", "inspiration-geometry", "iron-grip", "kinda-jean", "knitted-netting", "knitted-sweater", "kuji", "large-leather", "leather", "light-aluminum", "light-gray", "light-grey-floral-motif", "light-honeycomb-dark", "light-honeycomb", "light-mesh", "light-paper-fibers", "light-sketch", "light-toast", "light-wool", "lined-paper", "lined-paper-2", "little-knobs", "little-pluses", "little-triangles", "low-contrast-linen", "lyonnette", "maze-black", "maze-white", "mbossed", "medic-packaging-foil", "merely-cubed", "micro-carbon", "mirrored-squares", "mocha-grunge", "mooning", "moulin", "my-little-plaid-dark", "my-little-plaid", "nami", "nasty-fabric", "natural-paper", "navy", "nice-snow", "nistri", "noise-lines", "noise-pattern-with-subtle-cross-lines", "noisy-grid", "noisy-net", "noisy", "norwegian-rose", "notebook-dark", "notebook", "office", "old-husks", "old-map", "old-mathematics", "old-moon", "old-wall", "otis-redding", "outlets", "p1", "p2", "p4", "p5", "p6", "padded-light", "padded", "paper", "paper-1", "paper-2", "paper-3", "paper-fibers", "paven", "perforated-white-leather", "pineapple-cut", "pinstripe-dark", "pinstripe-light", "pinstriped-suit", "pixel-weave", "polaroid", "polonez-pattern", "polyester-lite", "pool-table", "project-paper", "ps-neutral", "psychedelic", "purty-wood", "pw-pattern", "pyramid", "quilt", "random-grey-variations", "ravenna", "real-carbon-fibre", "rebel", "redox-01", "redox-02", "reticular-tissue", "retina-dust", "retina-wood", "retro-intro", "rice-paper", "rice-paper-2", "rice-paper-3", "robots", "rocky-wall", "rough-cloth-light", "rough-cloth", "rough-diagonal", "rubber-grip", "sandpaper", "satin-weave", "scribble-light", "shattered-dark", "shattered", "shine-caro", "shine-dotted", "shley-tree-1", "shley-tree-2", "silver-scales", "simple-dashed", "simple-horizontal-light", "skeletal-weave", "skewed-print", "skin-side-up", "skulls", "slash-it", "small-crackle-bright", "small-crosses", "smooth-wall-dark", "smooth-wall-light", "sneaker-mesh-fabric", "snow", "soft-circle-scales", "soft-kill", "soft-pad", "soft-wallpaper", "solid", "sos", "sprinkles", "squairy", "squared-metal", "squares", "stacked-circles", "stardust", "starring", "stitched-wool", "strange-bullseyes", "straws", "stressed-linen", "stucco", "subtle-carbon", "subtle-dark-vertical", "subtle-dots", "subtle-freckles", "subtle-grey", "subtle-grunge", "subtle-stripes", "subtle-surface", "subtle-white-feathers", "subtle-zebra-3d", "subtlenet", "swirl", "tactile-noise-dark", "tactile-noise-light", "tapestry", "tasky", "tex2res1", "tex2res2", "tex2res3", "tex2res4", "tex2res5", "textured-paper", "textured-stripes", "texturetastic-gray", "ticks", "tileable-wood-colored", "tileable-wood", "tiny-grid", "translucent-fibres", "transparent-square-tiles", "tree-bark", "triangles", "triangles-2", "triangular", "tweed", "twinkle-twinkle", "txture", "type", "use-your-illusion", "vaio", "vertical-cloth", "vichy", "vintage-speckles", "wall-4-light", "washi", "wave-grid", "wavecut", "weave", "wet-snow", "white-bed-sheet", "white-brick-wall", "white-brushed", "white-carbon", "white-carbonfiber", "white-diamond-dark", "white-diamond", "white-leather", "white-linen", "white-paperboard", "white-plaster", "white-sand", "white-texture", "white-tiles", "white-wall", "white-wall-2", "white-wall-3", "white-wall-3-2", "white-wave", "whitey", "wide-rectangles", "wild-flowers", "wild-oliva", "wine-cork", "wood-pattern", "wood", "worn-dots", "woven-light", "woven", "xv", "zig-zag"];

/**
 * The FONTS array holds all of the font family options.
 * Origin: https://fonts.google.com
 * The fonts are imported in the index.html (within the head).
 */
const FONTS = ["Lobster", "Open Sans", "Roboto", "Dancing Script"];

/**
 * The COLORS map holds all of the color options that the user has to chooose
 * from. These were generated by Coolors, thanks Coolors! (https://coolors.co)!
 */
const COLORS = new Map([
  [
    "Sunshine",
    {
      primary: "#FB8500",
      secondary: "#FFB703",
      font: "#023047",
    },
  ],
  [
    "Cool Running",
    {
      primary: "#CAF0F8",
      secondary: "#90E0EF",
      font: "#03045E",
    },
  ],
  [
    "Warm Wishes",
    {
      primary: "#DDA15E",
      secondary: "#540B0E",
      font: "#FFF3B0",
    },
  ],
  [
    "Go Green",
    {
      primary: "#606C38",
      secondary: "#283618",
      font: "#FEFAE0",
    },
  ],
  [
    "Lovey Dove",
    {
      primary: "#F5CAC3",
      secondary: "#F28482",
      font: "#F7EDE2",
    },
  ],
  [
    "Go Chiefs!",
    {
      primary: "#D00000",
      secondary: "#FFBA08",
      font: "#03071E",
    },
  ],
]);

export let settings = {
  message: "",
  greeting: "",
  icon: "",
  color: {
    primary: '',
    secondary: '',
    font: '',
  },
};

/**
 * This function will change the settings variable based on what the user
 * selected. Example:
 * 1. User selects a color
 * 2. This function is executed
 * 3. The "settins.color" property is updated to their selection
 * @param {ChangeEvent} event 
 */
const onChange = (event) => {
  const element = event.target;
  const { id, value } = element;

  if (id === 'color') {
    console.log('Color!');
    const color = COLORS.get(value);
    settings.color = color;
  } else {
    // This is using syntactic sugar to set the property on the fly... This
    // prevents having to use a switch statement.
    // example: settings["greeting"] = "Hello world!"
    settings[id] = value;
  }
};

/**
 * This function generates a link.
 */
function share() {
  const encoded = serialize(settings);
  const url = `${window.location}${encoded}`;
  window.location.replace(url);
}

/**
 * This function encodes the settings into base64
 * @param {object} settings 
 * @returns {string} A base64 encoding of the settings
 */
export function serialize(settings) {
  const data = JSON.stringify(settings);
  const encoded = btoa(data);
  return encoded;
}

/**
 * This function decodes a base64 encoding back into a settings object
 * @param {string} encoded 
 * @returns {object} The settings object
 */
export function deserialize(encoded) {
  const decoded = atob(encoded);
  const data = JSON.parse(decoded);
  return data;
}

/**
 * This renders the Customize panel.
 * @returns {ReactElement} The customize card panel component
 */
export default function Customize() {
  let i = 0;
  const colorOpts = [];
  for (const [name] of COLORS) {
    colorOpts.push(
      <option key={i} value={name}>
        {name}
      </option>
    );
    i += 1;
  }

  return (
    <div className="customization">
      <h1>Customize Your Card 🎨</h1>

      {/* Greeting Message Input Text Box */}
      <input
        type="text"
        id="greeting"
        onChange={onChange}
        placeholder="Greeting"
      ></input>

      {/* Icon */}
      <select id="icon" onChange={onChange}>
        {ICONS.map((icon) => {
          i += 1;
          return <option key={i} value={icon}>{icon}</option>;
        })}
      </select>

      {/* Color Themes Selection */}
      <select id="color" onChange={onChange}>{colorOpts}</select>

      {/* Font Selection */}
      <select id="font" onChange={onChange}>
        {FONTS.map((fontName) => {
          i += 1;
          return (
            <option key={i} value={fontName}>
              {fontName}
            </option>
          );
        })}
      </select>

      {/* Background Pattern */}
      <select id="pattern" onChange={onChange}>
        {PATTERNS.map((pattern) => {
          i += 1;
          return (
            <option key={i} value={pattern}>
              {pattern}
            </option>
          );
        })}
      </select>
      {/* Message */}
      <textarea
        id="message"
        rows="7"
        cols="20"
        onChange={onChange}
        placeholder="Write your message here."
      ></textarea>
      {/* Share Button */}
      <input type='button' onClick={share} value='Share'></input>
    </div>
  );
}
